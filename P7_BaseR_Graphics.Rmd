---
title: "Introduction to R Syntax 2020"
pagetitle: "Part 7: Base R Graphics"
output:
  learnr::tutorial:
    theme: spacelab
    ace_theme: dawn
    progressive: true
    allow_skip: true
    highlight: pygments
    toc: yes
    toc_depth: 2
    code_folding: hide
runtime: shiny_prerendered
description: "Introduction to base R graphics capabilities"
---


```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE)
```

<!-- ======================== -->
## üü¢ What you will learn
<!-- ======================== -->

By the end of this tutorial, you will understand the basic graphics capabilities in base R. You will learn how to create line plots of mathematical functions, histograms of simulated data, and diagnostic plots to assess normality of distributions. These fundamental plotting skills form the foundation for data visualization in R and will help you explore and communicate your data effectively.

Base R graphics are powerful, fast, and require no additional packages. While packages like ggplot2 offer advanced features, base R graphics provide an excellent starting point and remain widely used for quick exploratory analysis and publication-quality figures.


<!-- ======================== -->
## üü¢ About this tutorial
<!-- ======================== -->

This tutorial demonstrates three essential types of plots in base R:

1. **Line plots** for visualizing mathematical functions
2. **Histograms** for understanding data distributions
3. **Normality diagnostic plots** for assessing whether data follows a normal distribution

Each section includes explanations and fully functional code boxes that you can modify and execute to see how the graphics change. Feel free to experiment with the parameters and try your own variations.


<!-- ======================== -->
## ‚úÖÔ∏è Line Plot of a Function
<!-- ======================== -->

One of the most common tasks in data analysis and scientific computing is plotting a mathematical function. Base R makes this straightforward with the `plot()` and `curve()` functions.

Let's start by plotting a simple quadratic function: $f(x) = x^2 - 4x + 3$

```{r quadratic-plot, exercise=TRUE}
# Define the function
f <- function(x) {
  x^2 - 4*x + 3
}

# Create a sequence of x values
x <- seq(-1, 5, length.out = 100)

# Calculate corresponding y values
y <- f(x)

# Create the plot
plot(x, y, 
     type = "l",           # "l" for line plot
     col = "blue",         # line color
     lwd = 2,              # line width
     main = "Quadratic Function: f(x) = x¬≤ - 4x + 3",
     xlab = "x",
     ylab = "f(x)",
     las = 1)              # rotate y-axis labels

# Add a grid for easier reading
grid()

# Add a horizontal line at y = 0
abline(h = 0, col = "red", lty = 2)
```

The `plot()` function is highly customizable. Try changing:

- The range of x values in `seq()`
- The line color (`col`)
- The line width (`lwd`)
- The line type by changing `type` to `"b"` (both points and lines)

### Alternative: Using the curve() function

R also provides a `curve()` function that's even more convenient for plotting mathematical functions:

```{r curve-plot, exercise=TRUE}
# Plot the function directly using curve()
curve(x^2 - 4*x + 3, 
      from = -1, 
      to = 5,
      col = "darkgreen",
      lwd = 2,
      main = "Using curve() Function",
      xlab = "x",
      ylab = "f(x)",
      las = 1)

grid()
abline(h = 0, col = "red", lty = 2)

# Add the vertex point
abline(v = 2, col = "red", lty = 2)  # vertical line at x = 2
points(2, -1, col = "red", pch = 19, cex = 1.5)
text(2, -1, "  Vertex (2, -1)", pos = 4, col = "red")
```

Try modifying the function expression or adding more annotation elements like `points()`, `text()`, or `arrows()`.


<!-- ======================== -->
## ‚úÖÔ∏è Histogram of Simulated Heights
<!-- ======================== -->

Histograms are essential for understanding the distribution of data. Let's simulate the heights of students and visualize the distribution.

We'll assume student heights follow a normal distribution with mean 170 cm and standard deviation 10 cm.

```{r histogram-basic, exercise=TRUE}
# Set seed for reproducibility
set.seed(12345)

# Simulate heights of 500 students
# Mean = 172 cm, SD = 10 cm
heights <- rnorm(n = 500, mean = 172, sd = 10)

# Create histogram
hist(heights,
     breaks = 20,              # number of bins
     col = "lightblue",
     border = "white",
     main = "Distribution of Student Heights",
     xlab = "Height (cm)",
     ylab = "Frequency",
     las = 1)

# Add a vertical line at the mean
abline(v = mean(heights), col = "red", lwd = 2, lty = 2)

# Add text annotation
text(mean(heights), max(hist(heights, plot = FALSE)$counts) * 0.35,
     paste("Mean =", round(mean(heights), 1), "cm"),
     pos = 4, col = "red")
```

Try experimenting with:

- Different numbers of students (change `n`)
- Different mean and standard deviation values
- Number of breaks (bins) in the histogram
- Adding more statistical lines (e.g., median with `median()`)

### Density Histogram with Curve Overlay

We can also create a density histogram and overlay the theoretical normal distribution:

```{r histogram-density, exercise=TRUE}
# Set seed for reproducibility
set.seed(12345)

# Simulate heights
heights <- rnorm(n = 500, mean = 172, sd = 10)

# Create density histogram (probability scale, not frequency)
hist(heights,
     breaks = 20,
     col = "lightblue",
     border = "white",
     main = "Distribution of Student Heights with Normal Curve",
     xlab = "Height (cm)",
     ylab = "Density",
     probability = TRUE,  # Show density instead of frequency
     las = 1)

# Overlay the theoretical normal distribution curve
curve(dnorm(x, mean = mean(heights), sd = sd(heights)),
      add = TRUE,
      col = "darkblue",
      lwd = 2)

# Add legend
legend("topright", 
       legend = c("Observed", "Normal distribution"),
       fill = c("lightblue", NA),
       border = c("white", NA),
       lty = c(NA, 1),
       col = c(NA, "darkblue"),
       lwd = c(NA, 2))
```


<!-- ======================== -->
## ‚úÖÔ∏è Assessing Normality
<!-- ======================== -->

A crucial question in statistics is whether your data follows a normal distribution. Base R provides several diagnostic plots to assess normality.

### Q-Q Plot (Quantile-Quantile Plot)

The Q-Q plot compares the quantiles of your data against the quantiles of a theoretical normal distribution. If the data is normally distributed, the points should fall approximately on a straight line.

```{r qq-plot, exercise=TRUE}
# Set seed for reproducibility
set.seed(456)

# Simulate normally distributed data
normal_data <- rnorm(200, mean = 50, sd = 10)

# Create Q-Q plot
qqnorm(normal_data,
       main = "Q-Q Plot: Normal Data",
       col = "blue",
       pch = 19,
       cex = 0.8)

# Add reference line
qqline(normal_data, 
       col = "red", 
       lwd = 2)

# The points should fall close to the red line for normal data
```

Now let's see what happens with non-normal data:

```{r qq-plot-skewed, exercise=TRUE}
# Set seed for reproducibility
set.seed(456)

# Simulate skewed data (exponential distribution)
skewed_data <- rexp(200, rate = 0.1)

# Create Q-Q plot
qqnorm(skewed_data,
       main = "Q-Q Plot: Skewed (Non-Normal) Data",
       col = "darkgreen",
       pch = 19,
       cex = 0.8)

# Add reference line
qqline(skewed_data, 
       col = "red", 
       lwd = 2)

# Notice how the points deviate from the red line,
# indicating non-normality
```

### Multi-Panel Diagnostic Plot

Let's create a comprehensive 2x2 panel showing multiple diagnostic plots:

```{r diagnostic-panel, exercise=TRUE}
# Set seed for reproducibility
set.seed(789)

# Simulate data
data <- rnorm(300, mean = 100, sd = 15)

# Create a 2x2 panel of plots
par(mfrow = c(2, 2))  # Set up 2x2 plotting area

# 1. Histogram with density curve
hist(data,
     breaks = 20,
     col = "lightgreen",
     border = "white",
     main = "Histogram",
     xlab = "Value",
     probability = TRUE,
     las = 1)
curve(dnorm(x, mean = mean(data), sd = sd(data)),
      add = TRUE, col = "darkgreen", lwd = 2)

# 2. Q-Q Plot
qqnorm(data, main = "Q-Q Plot", col = "blue", pch = 19, cex = 0.6)
qqline(data, col = "red", lwd = 2)

# 3. Boxplot
boxplot(data,
        main = "Boxplot",
        ylab = "Value",
        col = "lightyellow",
        border = "orange",
        horizontal = FALSE)

# 4. Index plot (values vs. observation number)
plot(data,
     type = "b",
     main = "Index Plot",
     xlab = "Observation",
     ylab = "Value",
     col = "purple",
     pch = 19,
     cex = 0.6)
abline(h = mean(data), col = "red", lty = 2)

# Reset to single plot
par(mfrow = c(1, 1))
```

Try modifying this code to:

- Use different distributions (e.g., `runif()` for uniform, `rt()` for t-distribution)
- Change the number of observations
- Adjust the visual styling of the plots


<!-- ======================== -->
## üü¢ Summary
<!-- ======================== -->

Congratulations! You've learned the basics of base R graphics:

1. **Line plots** using `plot()` and `curve()` to visualize mathematical functions
2. **Histograms** using `hist()` to understand data distributions
3. **Normality diagnostics** using Q-Q plots and multi-panel displays

These tools form the foundation of exploratory data analysis in R. As you continue your R journey, you can explore more advanced graphics with packages like ggplot2, but base R graphics will always be valuable for quick visualizations and understanding your data.

### Key Functions Covered

- `plot()` - create scatter plots and line plots
- `curve()` - plot mathematical functions
- `hist()` - create histograms
- `qqnorm()` and `qqline()` - create Q-Q plots for normality assessment
- `par()` - control plotting parameters
- Annotation functions: `abline()`, `points()`, `text()`, `legend()`, `grid()`

Keep experimenting with these functions and explore the R documentation (`?plot`, `?hist`, etc.) to discover more customization options!


## üìå License


<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

## üìå Tutorials &  online-resources

  Graphs in R:
  
  1. https://r-graphics.org/  (online book)
  2. https://r-charts.com/ (base-R and ggplot2)
  3. https://r-graph-gallery.com/ (400 examples, 50 chart types)
  4. https://github.com/iamericfletcher/awesome-r-learning-resources (The Viz section)
  5. https://www.data-to-viz.com/ (beautiful hierarchical presentation)

  About functions in R:
  
  1. https://www.datacamp.com/tutorial/functions-in-r-a-tutorial (Easy to follow)
  2. https://rstudio.github.io/r-manuals/r-intro/Writing-your-own-functions.html 
  3. https://masterr.org/r/RFP-part7-functions00/ (Functions, variables bindings and environments)
  4. https://masterr.org/r/RFP-part8-functions01/ and https://masterr.org/r/understand-r-environments-part2/ (environments)
  5. https://masterr.org/r/RFP-part8-functions01/ (Short blog post, but a chain of posts follow to explain more complex concepts)

  General:
  
  1. https://cran.r-project.org/manuals.html (all of them)
  2. https://github.com/iamericfletcher/awesome-r-learning-resources 
  3. https://statisticsglobe.com/r-programming-language [@StatisticsGlobe]
  4. https://datacarpentry.org/R-ecology-lesson/01-intro-to-r.html [@TheCarpentries.org.home]
  5. https://cran.r-project.org/doc/manuals/r-release/R-intro.html (Introduction)
  6. https://posit.cloud/learn/recipes (simple but useful)
  7. https://www.burns-stat.com/pages/Tutor/R_inferno.pdf [@TheRInferno] (no sugar coating)
  8. https://www.w3schools.in/r-programming
  
  <!-- 6. http://courtneybrown.com/YouTube/R_Tutorial_Videos.html (time-proven simple explanations) -->
  
  Computing: 
  
  1. http://adv-r.had.co.nz/ (Free access to Advanced R book by Wickham himself)
  2. https://cran.r-project.org/doc/manuals/r-release/R-exts.pdf (writing R packages)
  2. https://cran.r-project.org/doc/manuals/r-release/R-ints.html (low level language details)
  3. https://www.stat.berkeley.edu/~s133/ [@UBerkeleyS133.ConceptsComputeWithData]
  
  Data cleaning:
  
  1. https://cran.r-project.org/doc/contrib/de_Jonge+van_der_Loo-Introduction_to_data_cleaning_with_R.pdf
  
  Statistics:
  
  1. https://cran.r-project.org/doc/contrib/Lemon-kickstart/ (very short but juicy)
  2. https://www.youtube.com/playlist?list=PLDcUM9US4XdMROZ57-OIRtIK0aOynbgZN (Statistical Rethinking playlist)
  3. https://keithmcnulty.github.io/siop-lec-workshop-2025/materials/talks/1-preliminaries.html#1 (Fundamentals of Regression Analysis applied to People Data in R)
  4. https://github.com/rmcelreath/stat_rethinking_2022 (Statistical Rethinking resources)
  5. https://www.stat.berkeley.edu/~spector/s243/
  
  Biology:
  
  1. https://www.bioconductor.org/ (packages for bio-statistics)
  2. https://a-little-book-of-r-for-bioinformatics.readthedocs.io/en/latest/index.html
  3. https://github.com/eacton/CAGEF (University of Toronto - Centre for the Analysis of Genome Evolution & Function)

  Language Reference:
  
  1. https://cran.r-project.org/doc/manuals/r-release/fullrefman.pdf (latest)  

## üìå References
